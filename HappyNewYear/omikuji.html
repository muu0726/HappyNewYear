<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>おみくじ結果 - 2026</title>
    <style>
        :root {
            --gold: #d4af37;
            --deep-red: #8e0000;
            --bright-red: #c0392b;
            --black: #2c3e50;
            --white: #ffffff;
            --glitter: linear-gradient(45deg, #755010 0%, #d4af37 45%, #f9f0b3 50%, #d4af37 55%, #755010 100%);
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: #fcfaf2;
            font-family: "Yu Mincho", "MS PMincho", serif;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* 紙吹雪用 */
        }

        /* 大大吉専用背景エフェクト */
        body.special-bg {
            background: radial-gradient(circle, #fff9e6 0%, #fcfaf2 100%);
        }

        .result-card {
            background: white;
            padding: 50px 30px;
            border: 2px solid var(--gold);
            outline: 6px double var(--gold);
            outline-offset: -12px;
            text-align: center;
            max-width: 450px;
            width: 85%;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            position: relative;
            z-index: 10;
            animation: slideIn 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }

        .fortune-title {
            font-size: 1.1rem;
            color: #666;
            letter-spacing: 0.2em;
            margin-bottom: 5px;
        }

        #fortune-rank {
            font-size: 4.5rem;
            margin: 15px 0;
            font-weight: bold;
            display: block;
            min-height: 1.2em;
        }

        /* ランク別カラー */
        .color-pos { color: var(--bright-red); }
        .color-mid { color: var(--deep-red); }
        .color-neg { color: var(--black); }
        
        /* 大大吉：金色の輝きアニメーション */
        .color-daidaikichi {
            background: var(--glitter);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 3s linear infinite;
            filter: drop-shadow(0 0 5px rgba(212, 175, 55, 0.3));
        }

        .decoration-diamond {
            font-size: 0.8rem;
            color: var(--gold);
            margin-bottom: 20px;
        }

        #fortune-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #333;
            margin: 20px 0 40px;
            padding: 20px 10px 0;
            border-top: 1px solid #eee;
            min-height: 5em;
        }

        .back-btn {
            display: inline-block;
            padding: 12px 30px;
            color: var(--gold);
            text-decoration: none;
            border: 1px solid var(--gold);
            font-size: 0.9rem;
            transition: all 0.3s;
            cursor: pointer;
            background: white;
        }

        .back-btn:hover {
            background: var(--gold);
            color: white;
        }

        /* キャンバス（紙吹雪用） */
        #celebration-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 5;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shine {
            to { background-position: 200% center; }
        }
    </style>
</head>
<body>

<canvas id="celebration-canvas"></canvas>

<div class="result-card">
    <div class="fortune-title">二〇二六年度 運勢</div>
    <div id="fortune-rank"></div>
    <div class="decoration-diamond">◆ ◇ ◆</div>
    <p id="fortune-text"></p>
    <a href="index.html" class="back-btn">トップに戻る</a>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const ranks = [
            { name: "大大吉", type: "daidaikichi", class: "color-daidaikichi" },
            { name: "大吉", type: "pos", class: "color-pos" },
            { name: "吉", type: "pos", class: "color-pos" },
            { name: "中吉", type: "pos", class: "color-pos" },
            { name: "小吉", type: "mid", class: "color-mid" },
            { name: "末吉", type: "mid", class: "color-mid" },
            { name: "凶", type: "neg", class: "color-neg" },
            { name: "大凶", type: "neg", class: "color-neg" }
        ];

        const messageBank = {
            daidaikichi: [
                "宇宙が味方しています。あなたが願うことは全て現実になる、伝説級の一年です。",
                "全ステータスがカンスト状態。何をやっても成功しかしないので、一番大きな夢に挑んで。",
                "宝くじ、懸賞、オーディション。全ての「当選」を引き寄せる最強の波動が出ています。",
                "歴史に名が残るレベルの幸運。あなたの存在自体が周りの運気まで爆上げします。",
                "神がかり的な直感。あなたが選んだ道が、そのまま黄金のロードになります。"
                // ...（以下、元のメッセージと同様。短縮のため一部省略して記載していますが、元のリストを維持してください）
            ],
            daikyo: ["今はどん底ですが、これ以上落ちることはありません。あとは上がるだけの超・上昇気流。"],
            pos: ["全方位から無双できる年！やりたいことは全部欲張ってみて。最高の1年になります。"],
            mid: ["大きな変化はないけれど、穏やかで充実した日常。無理せず自分のペースでいこう。"],
            neg: ["ちょっと疲れが溜まってるかも。無理に予定を詰め込まず、一人の時間を大切にして。"]
        };
        // ※実際の実装時はmessageBankの全リストをここに含めてください

        const rankDisplay = document.getElementById('fortune-rank');
        const textDisplay = document.getElementById('fortune-text');

        let finalResult;
        // 本番用：localStorageを使用
        // let savedResult = localStorage.getItem('omikuji_result_2026');
        
        // 抽選ロジック
        let selectedRank;
        const randomNum = Math.random() * 100;

        if (true) { 
            selectedRank = ranks.find(r => r.name === "大大吉");
        } else if (randomNum <= 6) { 
            selectedRank = ranks.find(r => r.name === "大凶");
        } else {
            const normalRanks = ranks.filter(r => r.name !== "大大吉" && r.name !== "大凶");
            selectedRank = normalRanks[Math.floor(Math.random() * normalRanks.length)];
        }

        const groupMessages = messageBank[selectedRank.type] || messageBank['pos'];
        const selectedMessage = groupMessages[Math.floor(Math.random() * groupMessages.length)];

        finalResult = {
            name: selectedRank.name,
            className: selectedRank.class,
            text: selectedMessage
        };

        // 表示適用
        if (rankDisplay && textDisplay) {
            rankDisplay.innerText = finalResult.name;
            rankDisplay.className = finalResult.className;
            textDisplay.innerText = finalResult.text;

            // --- 大大吉の特別演出 ---
            if (finalResult.name === "大大吉") {
                document.body.classList.add('special-bg');
                startCelebration();
            }
        }

        // 紙吹雪アニメーション関数
        function startCelebration() {
            const canvas = document.getElementById('celebration-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const colors = ['#d4af37', '#f9f0b3', '#aa8439', '#ffffff'];

            for (let i = 0; i < 150; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    size: Math.random() * 7 + 4,
                    speed: Math.random() * 3 + 2,
                    angle: Math.random() * 360,
                    rotation: Math.random() * 10 - 5,
                    color: colors[Math.floor(Math.random() * colors.length)]
                });
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate(p.angle * Math.PI / 180);
                    ctx.fillStyle = p.color;
                    ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
                    ctx.restore();

                    p.y += p.speed;
                    p.angle += p.rotation;

                    if (p.y > canvas.height) {
                        p.y = -20;
                        p.x = Math.random() * canvas.width;
                    }
                });
                requestAnimationFrame(draw);
            }
            draw();
        }
    });
</script>
</body>
</html>

